/* empty css                                 */
import { a as createComponent, r as renderComponent, b as renderTemplate, m as maybeRenderHead, F as Fragment, d as addAttribute } from '../chunks/astro/server_DfIlsqH_.mjs';
import 'kleur/colors';
import { g as getSiteInfo, c as getPageData, b as getNoticias, d as getCategoriasNoticias, $ as $$MainLayout } from '../chunks/MainLayout_CruwIgCf.mjs';
/* empty css                                 */
export { renderers } from '../renderers.mjs';

const $$Index = createComponent(async ($$result, $$props, $$slots) => {
  const stripHtml = (html) => html?.replace?.(/<[^>]*>/g, "").trim() || "";
  const formatDate = (dateString) => {
    if (!dateString) return "";
    const date = new Date(dateString);
    return date.toLocaleDateString("es-ES", {
      year: "numeric",
      month: "long",
      day: "numeric"
    });
  };
  let hasError = false;
  let errorMessage = "";
  let siteInfo = null;
  let pageData = null;
  let noticiasData = null;
  let categoriasData = null;
  try {
    siteInfo = await getSiteInfo();
    pageData = await getPageData("noticias");
    noticiasData = await getNoticias({ limit: 2e4 });
    categoriasData = await getCategoriasNoticias();
    if (!siteInfo || !siteInfo.title) {
      throw new Error("No se pudo obtener el t\xEDtulo del sitio desde WordPress");
    }
  } catch (error) {
    hasError = true;
    errorMessage = `Error conectando con WordPress: ${error.message}`;
  }
  const noticias = hasError ? [] : noticiasData?.noticias || [];
  const categorias = hasError ? [] : categoriasData?.categorias || [];
  const heroTitle = hasError ? null : pageData?.title || "\xDAltimas Noticias";
  const heroDescription = hasError ? null : pageData?.excerpt || "Mantente al d\xEDa con las \xFAltimas noticias de m\xFAsica, vinilo y cultura musical";
  const pageTitle = hasError ? "Error - Noticias" : pageData?.seo?.title || `${heroTitle} - VinylStation`;
  const pageDescription = hasError ? "Error cargando contenido" : pageData?.seo?.metaDesc || heroDescription;
  const noticiasPorCategoria = noticias.reduce((acc, noticia) => {
    const cats = noticia.categorias?.nodes || [];
    cats.forEach((cat) => {
      if (!acc[cat.name]) acc[cat.name] = 0;
      acc[cat.name]++;
    });
    return acc;
  }, {});
  return renderTemplate`${renderComponent($$result, "MainLayout", $$MainLayout, { "title": `${pageTitle} | ${siteInfo?.title || "VinylStation"}`, "description": pageDescription, "data-astro-cid-memwiw23": true }, { "default": async ($$result2) => renderTemplate`${hasError ? renderTemplate`${maybeRenderHead()}<div class="container" data-astro-cid-memwiw23> <div class="error-container" data-astro-cid-memwiw23> <div class="error-icon" data-astro-cid-memwiw23>üì∞</div> <h1 class="error-title" data-astro-cid-memwiw23>Error Cargando Noticias</h1> <p class="error-message" data-astro-cid-memwiw23>${errorMessage}</p> <div class="error-details" data-astro-cid-memwiw23> <h3 data-astro-cid-memwiw23>Posibles soluciones:</h3> <ul data-astro-cid-memwiw23> <li data-astro-cid-memwiw23>Verificar conexi√≥n a: https://cms.vinylstation.es/graphql</li> <li data-astro-cid-memwiw23>Comprobar que WordPress est√© funcionando</li> <li data-astro-cid-memwiw23>Revisar configuraci√≥n de GraphQL y ACF</li> <li data-astro-cid-memwiw23>Verificar que las noticias tengan campos configurados</li> </ul> </div> <div class="error-actions" data-astro-cid-memwiw23> <button onclick="window.location.reload()" class="btn primary-btn" data-astro-cid-memwiw23>
üîÑ Reintentar
</button> <a href="/" class="btn secondary-btn" data-astro-cid-memwiw23>‚Üê Volver al inicio</a> </div> </div> </div>` : renderTemplate`${renderComponent($$result2, "Fragment", Fragment, { "data-astro-cid-memwiw23": true }, { "default": async ($$result3) => renderTemplate`  <div class="container" data-astro-cid-memwiw23> <header class="page-header" data-astro-cid-memwiw23> ${siteInfo.logo?.url && renderTemplate`<div class="site-icon-container" data-astro-cid-memwiw23> <img${addAttribute(siteInfo.logo.url, "src")}${addAttribute(siteInfo.logo.altText || "Logo", "alt")} class="site-icon" data-astro-cid-memwiw23> </div>`} <h1 data-astro-cid-memwiw23>${heroTitle}</h1> <p class="page-description" data-astro-cid-memwiw23>${heroDescription}</p> <div class="news-stats" data-astro-cid-memwiw23> <div class="stat-card" data-astro-cid-memwiw23> <span class="stat-number" data-astro-cid-memwiw23>${noticias.length}</span> <span class="stat-label" data-astro-cid-memwiw23>Noticias</span> </div> <div class="stat-card" data-astro-cid-memwiw23> <span class="stat-number" data-astro-cid-memwiw23>${categorias.length}</span> <span class="stat-label" data-astro-cid-memwiw23>Categor√≠as</span> </div> <div class="stat-card" data-astro-cid-memwiw23> <span class="stat-number" data-astro-cid-memwiw23>24h</span> <span class="stat-label" data-astro-cid-memwiw23>Actualizadas</span> </div> </div> <div class="hero-actions" data-astro-cid-memwiw23> <a href="/programas" class="btn secondary-btn" data-astro-cid-memwiw23>Ver Programas</a> <a href="#noticias" class="btn primary-btn" data-astro-cid-memwiw23>Leer Noticias</a> </div> </header> </div>  ${categorias.length > 0 && renderTemplate`<section class="categories-section" data-astro-cid-memwiw23> <div class="categories-container" data-astro-cid-memwiw23> <h3 class="categories-title" data-astro-cid-memwiw23>Explorar por Categor√≠a</h3> <div class="categories-grid" data-astro-cid-memwiw23> <button class="category-filter active" data-category="all" data-astro-cid-memwiw23>
Todas las Noticias
<span class="category-count" data-astro-cid-memwiw23>${noticias.length}</span> </button> ${categorias.map((categoria) => renderTemplate`<button class="category-filter"${addAttribute(categoria.slug, "data-category")} data-astro-cid-memwiw23> ${categoria.name} <span class="category-count" data-astro-cid-memwiw23>${noticiasPorCategoria[categoria.name] || 0}</span> </button>`)} </div> </div> </section>`} <section id="noticias" class="news-section" data-astro-cid-memwiw23> <div class="news-container" data-astro-cid-memwiw23> <h2 class="news-title" data-astro-cid-memwiw23>Todas las Noticias</h2> ${noticias.length > 0 ? renderTemplate`<div class="news-grid" data-astro-cid-memwiw23> ${noticias.map((noticia) => {
    const imagen = noticia.imagenDestacadaUrl || noticia.featuredImage?.node?.sourceUrl || "/images/placeholder-news.jpg";
    const rawDesc = noticia.excerpt || `Noticia "${noticia.title}" - \xDAltimas noticias de VinylStation`;
    const descripcion = stripHtml(rawDesc);
    const categoriasNoticia = noticia.categorias?.nodes || [];
    const fechaPublicacion = formatDate(noticia.date);
    return renderTemplate`<article class="news-card"${addAttribute(categoriasNoticia.map((c) => c.slug).join(" "), "data-categories")} data-astro-cid-memwiw23> <div class="news-image" data-astro-cid-memwiw23> <img${addAttribute(imagen, "src")}${addAttribute(noticia.featuredImage?.node?.altText || noticia.title, "alt")} loading="lazy" onerror="this.src='/images/placeholder-news.jpg'" data-astro-cid-memwiw23> <div class="news-overlay" data-astro-cid-memwiw23> <a${addAttribute(`/noticias/${noticia.slug || noticia.id}`, "href")} class="news-link" data-astro-cid-memwiw23>
Leer Noticia
</a> </div> ${categoriasNoticia.length > 0 && renderTemplate`<div class="news-categories" data-astro-cid-memwiw23> ${categoriasNoticia.slice(0, 2).map((cat) => renderTemplate`<span class="category-badge"${addAttribute(cat.id, "key")} data-astro-cid-memwiw23>${cat.name}</span>`)} </div>`} </div> <div class="news-info" data-astro-cid-memwiw23> <h3 class="news-title-card" data-astro-cid-memwiw23>${noticia.title}</h3> <p class="news-description" data-astro-cid-memwiw23>${descripcion}</p> <div class="news-meta" data-astro-cid-memwiw23> <time class="news-date" data-astro-cid-memwiw23>${fechaPublicacion}</time> ${noticia.author?.node?.name && renderTemplate`<span class="news-author" data-astro-cid-memwiw23>Por ${noticia.author.node.name}</span>`} </div> </div> </article>`;
  })} </div>` : renderTemplate`<div class="no-news" data-astro-cid-memwiw23> <div class="no-news-icon" data-astro-cid-memwiw23>üì∞</div> <h3 data-astro-cid-memwiw23>No hay noticias disponibles</h3> <p data-astro-cid-memwiw23>Las noticias aparecer√°n aqu√≠ cuando sean publicadas en WordPress.</p> </div>`} </div> </section> ` })}`}` })}  `;
}, "C:/Users/nestu/Desktop/web vinylstation/astro_30-05/src/pages/noticias/index.astro", void 0);

const $$file = "C:/Users/nestu/Desktop/web vinylstation/astro_30-05/src/pages/noticias/index.astro";
const $$url = "/noticias.html";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
  __proto__: null,
  default: $$Index,
  file: $$file,
  url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
