document.addEventListener("DOMContentLoaded",function(){const x=document.querySelectorAll(".play-btn-grid"),E=document.querySelectorAll(".news-card-slider");class w{constructor(){this.audio=document.getElementById("radio-audio-index"),this.playPauseBtn=document.getElementById("play-pause-index"),this.playIcon=document.getElementById("play-icon-index"),this.pauseIcon=document.getElementById("pause-icon-index"),this.statusText=document.getElementById("status-text-index"),this.loadingIndicator=document.getElementById("loading-indicator-index"),this.volumeToggle=document.getElementById("volume-toggle-index"),this.volumeOnIcon=document.getElementById("volume-on-index"),this.volumeOffIcon=document.getElementById("volume-off-index"),this.volumeSlider=document.getElementById("volume-slider-index"),this.isPlaying=!1,this.isLoading=!1,this.init()}init(){if(!this.audio)return;const e=this.audio.getAttribute("data-stream-url");this.audio.src=e,this.audio.volume=parseFloat(this.volumeSlider?.value||.7),this.bindEvents()}bindEvents(){this.playPauseBtn?.addEventListener("click",()=>this.togglePlayPause()),this.volumeToggle?.addEventListener("click",()=>this.toggleMute()),this.volumeSlider?.addEventListener("input",e=>this.updateVolume(e.target.value)),this.audio?.addEventListener("loadstart",()=>this.setLoading(!0)),this.audio?.addEventListener("canplay",()=>this.setLoading(!1)),this.audio?.addEventListener("play",()=>this.setPlaying(!0)),this.audio?.addEventListener("pause",()=>this.setPlaying(!1)),this.audio?.addEventListener("error",()=>this.handleError()),this.audio?.addEventListener("stalled",()=>this.setLoading(!0)),this.audio?.addEventListener("waiting",()=>this.setLoading(!0)),this.audio?.addEventListener("playing",()=>this.setLoading(!1))}togglePlayPause(){this.audio&&(this.isPlaying?this.audio.pause():this.audio.play().catch(()=>this.handleError()))}setPlaying(e){this.isPlaying=e,e?(this.playIcon&&(this.playIcon.style.display="none"),this.pauseIcon&&(this.pauseIcon.style.display="block"),this.statusText&&(this.statusText.textContent="En vivo"),this.playPauseBtn?.classList.add("playing")):(this.playIcon&&(this.playIcon.style.display="block"),this.pauseIcon&&(this.pauseIcon.style.display="none"),this.statusText&&(this.statusText.textContent="Radio en vivo"),this.playPauseBtn?.classList.remove("playing"))}setLoading(e){this.isLoading=e,e?(this.loadingIndicator&&(this.loadingIndicator.style.display="block"),this.statusText&&(this.statusText.textContent="Conectando...")):(this.loadingIndicator&&(this.loadingIndicator.style.display="none"),this.isPlaying&&this.statusText&&(this.statusText.textContent="En vivo"))}toggleMute(){this.audio&&(this.audio.muted=!this.audio.muted,this.audio.muted?(this.volumeOnIcon&&(this.volumeOnIcon.style.display="none"),this.volumeOffIcon&&(this.volumeOffIcon.style.display="block")):(this.volumeOnIcon&&(this.volumeOnIcon.style.display="block"),this.volumeOffIcon&&(this.volumeOffIcon.style.display="none")))}updateVolume(e){this.audio&&(this.audio.volume=parseFloat(e),this.audio.muted=e==0,e==0?(this.volumeOnIcon&&(this.volumeOnIcon.style.display="none"),this.volumeOffIcon&&(this.volumeOffIcon.style.display="block")):(this.volumeOnIcon&&(this.volumeOnIcon.style.display="block"),this.volumeOffIcon&&(this.volumeOffIcon.style.display="none")))}handleError(){this.setLoading(!1),this.setPlaying(!1),this.statusText&&(this.statusText.textContent="Error de conexiÃ³n"),setTimeout(()=>{this.statusText&&(this.statusText.textContent="Radio en vivo")},3e3)}}new w,x.forEach((l,e)=>{l.addEventListener("click",f=>{f.stopPropagation(),l.style.transform="scale(0.8) rotate(15deg)",setTimeout(()=>{l.style.transform=""},200);const y=l.closest(".program-card-grid").querySelector(".program-title-grid h3")?.textContent;console.log(`ðŸŽµ Reproduciendo programa: ${y}`)})});const o=document.getElementById("newsSlider"),a=document.getElementById("newsPrevBtn"),d=document.getElementById("newsNextBtn"),c=document.getElementById("newsSliderDots");if(o&&a&&d&&c){let l=function(){const t=o.parentElement.offsetWidth;return t>=1200?4:t>=992?3:t>=768?2:1},e=function(){const t=l();return Math.max(0,h-t)},f=function(){c.innerHTML="";const t=e()+1;if(t<=1){c.style.display="none";return}c.style.display="flex";const n=Math.max(1,Math.floor(t/8));for(let i=0;i<t;i+=n){const u=document.createElement("div");u.className=`dot ${i===0?"active":""}`,u.setAttribute("data-slide",i),u.addEventListener("click",()=>r(i)),u.title=`Noticia ${i+1}`,c.appendChild(u)}},L=function(){c.querySelectorAll(".dot").forEach(n=>{const i=parseInt(n.getAttribute("data-slide"));n.classList.toggle("active",Math.abs(i-s)<2)})},y=function(){const t=e();if(t<=0){a.style.display="none",d.style.display="none";return}a.style.display="flex",d.style.display="flex",a.disabled=s<=0,d.disabled=s>=t,a.style.opacity=s<=0?"0.5":"1",d.style.opacity=s>=t?"0.5":"1"},r=function(t,n=!0){if(v||h===0)return;const i=e();s=Math.max(0,Math.min(t,i));const u=B[0].offsetWidth,O=s*(u+24);n&&(v=!0,setTimeout(()=>{v=!1},600)),o.style.transform=`translateX(-${O}px)`,L(),y()},g=function(){const t=e();s>=t?r(0):r(s+1)},S=function(){const t=e();s<=0?r(t):r(s-1)},p=function(){h<=l()||(m=setInterval(g,3e3))},T=function(){m&&(clearInterval(m),m=null)};const B=o.querySelectorAll(".news-card-slider"),h=B.length;if(h===0){a.style.display="none",d.style.display="none",c.style.display="none",console.log("ðŸ“° No hay noticias disponibles - controles ocultos");return}let s=0,v=!1,m;console.log(`ðŸ“° Slider de noticias iniciado con ${h} noticias`),d.addEventListener("click",g),a.addEventListener("click",S),o.addEventListener("mouseenter",T),o.addEventListener("mouseleave",p);let P;window.addEventListener("resize",()=>{clearTimeout(P),P=setTimeout(()=>{r(s,!1),f()},150)});let b=0,I=!1;o.addEventListener("touchstart",t=>{b=t.touches[0].clientX,I=!0,T()},{passive:!0}),o.addEventListener("touchend",t=>{if(!I)return;I=!1;const n=t.changedTouches[0].clientX,i=b-n;Math.abs(i)>50&&(i>0?g():S()),p()},{passive:!0}),E.forEach(t=>{t.addEventListener("click",n=>{if(!n.target.classList.contains("news-link")){const i=t.querySelector(".news-link");i&&(window.location.href=i.href)}})}),f(),y(),r(0,!1),p(),console.log(`âœ… Slider de noticias inicializado: ${h} noticias`)}console.log(`âœ… PÃ¡gina inicializada: ${x.length} programas, ${E.length} noticias`)});
